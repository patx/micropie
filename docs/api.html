<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MicroPie API Documentation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2em;
      line-height: 1.6;
      background-color: #f9f9f9;
    }
    h1, h2, h3, h4 {
      color: #333;
    }
    h1 {
      border-bottom: 2px solid #ccc;
      padding-bottom: 0.5em;
    }
    .class-section {
      background: #fff;
      border: 1px solid #ddd;
      padding: 1em;
      margin-bottom: 2em;
      border-radius: 4px;
    }
    .method, .attribute {
      margin-bottom: 1em;
    }
    code {
      background-color: #eee;
      padding: 0.1em 0.3em;
      border-radius: 3px;
    }
    pre {
      background: #f4f4f4;
      border: 1px solid #ddd;
      padding: 1em;
      overflow-x: auto;
    }
    .param-list {
      margin: 0.5em 0 0.5em 1em;
    }
  </style>
</head>
<body>
  <h1>MicroPie API Documentation</h1>
  <p><em>MicroPie: A simple Python ultra‚Äêmicro web framework with ASGI support.</em></p>
  <p>Documentation for all public and private (prefixed with <code>_</code>) methods.</p>

  <!-- ======================================================== -->
  <!-- Class: Request -->
  <!-- ======================================================== -->
  <div class="class-section" id="class-Request">
    <h2>Class: Request</h2>
    <p><strong>Description:</strong> Represents an HTTP request in the MicroPie framework.</p>

    <h3>Attributes</h3>
    <ul>
      <li><code>scope</code> (Dict[str, Any]): The ASGI scope dictionary for the request.</li>
      <li><code>method</code> (str): The HTTP method derived from the scope.</li>
      <li><code>path_params</code> (List[str]): List of URL path parameters.</li>
      <li><code>query_params</code> (Dict[str, List[str]]): Dictionary of query string parameters.</li>
      <li><code>body_params</code> (Dict[str, List[str]]): Dictionary of POST/PUT/PATCH body parameters.</li>
      <li><code>session</code> (Dict[str, Any]): Dictionary for session data.</li>
      <li><code>files</code> (Dict[str, Any]): Dictionary for uploaded files.</li>
    </ul>

    <h3>Methods</h3>
    <div class="method" id="Request.__init__">
      <h4><code>__init__(self, scope: Dict[str, Any]) -> None</code></h4>
      <p><strong>Description:</strong> Initialize a new Request instance.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>scope</code> (Dict[str, Any]): The ASGI scope dictionary for the request.</li>
      </ul>
    </div>
  </div>

  <!-- ======================================================== -->
  <!-- Class: App -->
  <!-- ======================================================== -->
  <div class="class-section" id="class-App">
    <h2>Class: App</h2>
    <p><strong>Description:</strong> ASGI application for handling HTTP requests and WebSocket connections in MicroPie.</p>

    <h3>Class Attributes</h3>
    <ul>
      <li><code>SESSION_TIMEOUT</code> (int): Session timeout value (8 hours, expressed in seconds).</li>
    </ul>

    <h3>Methods</h3>

    <div class="method" id="App.__init__">
      <h4><code>__init__(self) -> None</code></h4>
      <p><strong>Description:</strong> Initialize a new App instance. If Jinja2 is installed, sets up the template environment and initializes session storage.</p>
    </div>

    <div class="method" id="App.request">
      <h4><code>request(self) -> Request</code></h4>
      <p><strong>Description:</strong> Retrieve the current request from the context variable.</p>
      <p><strong>Returns:</strong> The current <code>Request</code> instance.</p>
    </div>

    <div class="method" id="App.__call__">
      <h4><code>__call__(self, scope: Dict[str, Any], receive: Callable[[], Awaitable[Dict[str, Any]]], send: Callable[[Dict[str, Any]], Awaitable[None]]) -> None</code></h4>
      <p><strong>Description:</strong> ASGI callable interface for the server. This method simply delegates to <code>_asgi_app</code>.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>scope</code>: The ASGI scope dictionary.</li>
        <li><code>receive</code>: The callable to receive ASGI events.</li>
        <li><code>send</code>: The callable to send ASGI events.</li>
      </ul>
    </div>

    <div class="method" id="App._asgi_app">
      <h4><code>_asgi_app(self, scope: Dict[str, Any], receive: Callable[[], Awaitable[Dict[str, Any]]], send: Callable[[Dict[str, Any]], Awaitable[None]]) -> None</code></h4>
      <p><strong>Description:</strong> ASGI application entry point for handling HTTP requests.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>scope</code>: The ASGI scope dictionary.</li>
        <li><code>receive</code>: The callable to receive ASGI events.</li>
        <li><code>send</code>: The callable to send ASGI events.</li>
      </ul>
    </div>

    <div class="method" id="App._parse_cookies">
      <h4><code>_parse_cookies(self, cookie_header: str) -> Dict[str, str]</code></h4>
      <p><strong>Description:</strong> Parse the Cookie header and return a dictionary of cookie names and values.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>cookie_header</code> (str): The raw Cookie header string.</li>
      </ul>
      <p><strong>Returns:</strong> A dictionary mapping cookie names to their corresponding values.</p>
    </div>

    <div class="method" id="App._parse_multipart">
      <h4><code>_parse_multipart(self, reader: asyncio.StreamReader, boundary: bytes) -> None</code></h4>
      <p><strong>Description:</strong> Parse <code>multipart/form-data</code> from the given reader using the specified boundary.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>reader</code> (asyncio.StreamReader): Contains the multipart data.</li>
        <li><code>boundary</code> (bytes): The boundary bytes extracted from the <code>Content-Type</code> header.</li>
      </ul>
      <p><strong>Notes:</strong> Requires the <code>multipart</code> and <code>aiofiles</code> packages to be installed.</p>
    </div>

    <div class="method" id="App._send_response">
      <h4><code>_send_response(self, send: Callable[[Dict[str, Any]], Awaitable[None]], status_code: int, body: Any, extra_headers: Optional[List[Tuple[str, str]]] = None) -> None</code></h4>
      <p><strong>Description:</strong> Send an HTTP response using the ASGI <code>send</code> callable.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>send</code>: The ASGI send callable.</li>
        <li><code>status_code</code> (int): The HTTP status code for the response.</li>
        <li><code>body</code>: The response body (string, bytes, or generator).</li>
        <li><code>extra_headers</code> (Optional[List[Tuple[str, str]]]): Optional additional header tuples.</li>
      </ul>
    </div>

    <div class="method" id="App._cleanup_sessions">
      <h4><code>_cleanup_sessions(self) -> None</code></h4>
      <p><strong>Description:</strong> Clean up expired sessions based on the <code>SESSION_TIMEOUT</code> value.</p>
    </div>

    <div class="method" id="App._redirect">
      <h4><code>_redirect(self, location: str) -> Tuple[int, str]</code></h4>
      <p><strong>Description:</strong> Generate an HTTP redirect response.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>location</code> (str): The URL to redirect to.</li>
      </ul>
      <p><strong>Returns:</strong> A tuple containing the HTTP status code (302) and an HTML body for redirection.</p>
    </div>

    <div class="method" id="App._render_template">
      <h4><code>_render_template(self, name: str, **kwargs: Any) -> str</code></h4>
      <p><strong>Description:</strong> Render a template asynchronously using Jinja2.</p>
      <p><strong>Parameters:</strong></p>
      <ul class="param-list">
        <li><code>name</code> (str): The name of the template file.</li>
        <li><code>**kwargs</code>: Additional keyword arguments passed to the template.</li>
      </ul>
      <p><strong>Returns:</strong> The rendered template as a string.</p>
      <p><strong>Raises:</strong> <code>ImportError</code> if Jinja2 is not installed.</p>
    </div>

  </div>

  <!-- ======================================================== -->
  <!-- Footer -->
  <!-- ======================================================== -->
  <footer>
    <p>&copy; Harrison Erd</p>
    <p>For more details, visit the <a href="https://patx.github.io/micropie" target="_blank">MicroPie website</a>.</p>
  </footer>
</body>
</html>

